==========================================================
**Лабораторна робота №1 Введення в розробку модулів ядра**
==========================================================

**Завдання:**
~~~~~~~~~~~~~~~
* Зібрати мінімальний модуль Linux-ядра вручну;
* Зібрати мінмальне Linux-оточення з використання BusyBox;
* Зібрати перший модуль ядра;
* Написати та зібрати власний модуль ядра який:
    * Виводить ім'я користувача передане в якості параметру модуля при його підключенні. Якщо параметр не задано, вивести попередження;
    * Доповнити *exit_callback* модуля, щоб він виводив значення *jiffies* та час в секундах від *init* до *exit*.
~~~~~~~~~~~~~~~

**Хід роботи:**

За основу власного модуля взято демонстративний модуль ``firstmodule``.

**Використані бібліотеки**
--------------------------

* ``<linux/module.h>`` потрібна для всіх модулів;
* ``<linux/kernel.h>`` використовується для *sysinfo*;
* ``<linux/init.h>`` використовується для ініціалізації та закриття;
* ``<linux/jiffies.h>`` тут "живе" лічильник та допоміжні функції;

**Використані макроси та функції**
----------------------------------

``MODULE_DESCRIPTION`` макрос для опису модуля;

``MODULE_AUTHOR`` автори модуля;

``MODULE_VERSION`` версія модуля;

``MODULE_LICENSE`` тип ліцензії. У нас подвійна, MIT/GPL;

``module_param`` використовується для передачі параметрів в модуль;

``jiffies_delta_to_msecs`` використовується для розрахунку проміжку часу. На вхід очікує різницю *jiffies*;

``printk`` використовується для виведення інформації в консоль;


Висновки
~~~~~~~~

Було зібрано мінімальне ядро linux та набір user space утиліт, Емуляція поводилася з використанням qemu . В блоці нижче показано результати роботи модулю з передачею параметра ``user`` та без.
При передачі без параметра, виводиться відповідне сповіщення в лог ядра з рівнем ``KERN_WARNING`` та ім'ям користувача - ``$username``. Також при вигрузці модуля виводиться час його роботи в секундах.

.. code-block:: bash

 / # insmod /mnt/lab1_mod.ko
 [   42.885206] khmod: loading out-of-tree module taints kernel.
 [   42.913503] Module starts without username
 [   42.913527] Hello, $username!
 [   42.913527]  Jiffies = 4294710227
 [   42.918248] insmod (93) used greatest stack depth: 13720 bytes left
 / # rmmod lab1_mod
 [   77.075720] Long live the Kernel! wrk time - 34 sec.
 / # insmod /mnt/lab1_mod.ko user="Boleslav"
 [  161.235307] Hello, Boleslav!
 [  161.235307]  Jiffies = 4294828549
 / # rmmod lab1_mod
 [  164.120527] Long live the Kernel! wrk time - 2 sec.
